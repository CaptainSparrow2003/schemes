#!/usr/bin/env bash

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"

if [[ "$EUID" != 0 ]]; then
  echo "This script should be run with sudo"
  exit
fi

schemeID=$(ls $SCRIPT_DIR/*.vst)
schemeID=${schemeID/$SCRIPT_DIR\//}
schemeID=${schemeID/.vst/}

if [ -z "$1" ]; then
  echo "Specify install or uninstall"
else
  if [ "$1" = "install" ]; then
    # Install Scheme

    sudo mkdir -p @INSTALL_PREFIX@/share/varnam/schemes/
    sudo cp *.vst @INSTALL_PREFIX@/share/varnam/schemes/

    echo "Installed basic $schemeID language support"
  elif [ "$1" = "uninstall" ]; then
    sudo rm "@INSTALL_PREFIX@/share/varnam/schemes/$schemeID.vst"
    sudo rmdir "@INSTALL_PREFIX@/share/varnam/schemes/"

    echo "Uninstallation finished"
  fi
fi
